---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Hero from '../../components/Hero.astro';
import { getProducts } from '../../lib/wp';
import { fallbackPaintings } from '../../lib/fallbackPaintings';
import { getBooleanEnv } from '../../lib/env';

const showEventsNews = getBooleanEnv(['PUBLIC_SHOW_EVENTS_NEWS', 'SHOW_EVENTS_NEWS'], true);
const paintingsFromWp = (await getProducts(12)).filter(painting => painting.image);
const paintings =
  paintingsFromWp.length > 0
    ? paintingsFromWp
    : fallbackPaintings.map(item => ({ ...item, link: '#!' }));
---

<BaseLayout
  lang="en"
  title="My Light Gallery Art – Art Gallery"
  description="Art gallery focused on high-quality contemporary and classic works"
  showEventsNews={showEventsNews}
>
  <Hero lang="en" showEventsNews={showEventsNews} />

  <section id="collections" class="section section-colecciones">
    <div class="container">
      <h2>Collections</h2>
      <p class="section-intro">
        Painting is my essential need and my most authentic way to express myself. Through color and creative freedom, I communicate emotions and feelings that words can’t fully convey. Painting is my natural language, an intimate space where my sensitivity flows.
      </p>
      
      <div class="paintings-carousel">
        <div class="carousel-container">
          <div class="carousel-track">
            {paintings.map(painting => {
              const captionParts = [
                painting.title,
                painting.dimensions,
                painting.priceText,
              ].filter(Boolean);
              return (
                <a
                  href={painting.image ?? '#!'}
                  class="painting-card"
                  data-full={painting.image ?? ''}
                  data-caption={captionParts.join(' • ')}
                >
                  <img
                    src={painting.image}
                    alt={painting.title}
                    loading="lazy"
                    decoding="async"
                  />
                  <h3>{painting.title}</h3>
                  <p class="painting-meta">
                    {painting.dimensions && <span>{painting.dimensions}</span>}
                    <span class="painting-price">
                      {painting.dimensions ? ' • ' : ''}
                      {painting.priceText ?? 'NO SELL'}
                    </span>
                  </p>
                </a>
              );
            })}
            {paintings.length === 0 && (
              <p class="paintings-empty">New works coming soon.</p>
            )}
          </div>
        </div>
        <div class="lightbox" id="lightbox" aria-hidden="true">
          <div class="lightbox-backdrop"></div>
          <div class="lightbox-content" role="dialog" aria-modal="true">
            <button class="lightbox-close" aria-label="Close detailed view">×</button>
            <img id="lightbox-img" alt="" />
            <p class="lightbox-caption"></p>
          </div>
        </div>
      </div>
    </div>
  </section>

  {showEventsNews && (
    <section id="events" class="section section-eventos">
      <div class="container">
        <div class="section-header">
          <h2>Events</h2>
          <a href="/en/#events" class="see-more-link">See More →</a>
        </div>
        <div class="events-grid">
          <div class="event-card">
            <div class="event-badge">NOW</div>
            <div class="event-image" style="background: #e5dcd3;"></div>
            <div class="event-content">
              <h3>Winter Exhibition 2026</h3>
              <p>An exclusive selection of contemporary and classic works</p>
              <a href="/en/#events" class="event-link">More info</a>
            </div>
          </div>
          <div class="event-card">
            <div class="event-badge">UPCOMING</div>
            <div class="event-image" style="background: #d8cec3;"></div>
            <div class="event-content">
              <h3>Art Fair Texas 2026</h3>
              <p class="event-location">DALLAS, TX</p>
              <p>FEB 15–23, 2026 STAND B3</p>
              <a href="/en/#events" class="event-link">More info</a>
            </div>
          </div>
        </div>
      </div>
    </section>
  )}

  {showEventsNews && (
    <section id="news" class="section section-noticias">
      <div class="container">
        <h2>News</h2>
        <div class="news-grid">
          <article class="news-card">
            <div class="news-image" style="background: #cfc5ba;"></div>
            <div class="news-content">
              <h3>New Acquisition: 19th Century Work</h3>
              <p>We are pleased to announce the acquisition of an exceptional 19th-century piece...</p>
              <a href="/en/#news" class="news-link">Read more</a>
            </div>
          </article>
          <article class="news-card">
            <div class="news-image" style="background: #bfb5aa;"></div>
            <div class="news-content">
              <h3>Featured Artist: Solo Exhibition</h3>
              <p>Discover the latest exhibition from one of the most promising contemporary artists...</p>
              <a href="/en/#news" class="news-link">Read more</a>
            </div>
          </article>
        </div>
        <div class="section-footer">
          <a href="/en/#news" class="btn-secondary">Latest News</a>
        </div>
      </div>
    </section>
  )}

  <section id="layla" class="section section-about">
    <div class="container">
      <h2>Layla</h2>
      <div class="about-content">
        <div class="about-text">
          <p>
            Layla González Camarena Soutou is a multidisciplinary visual artist whose work springs from a deep affinity with color, light, and free creative expression. With academic training in Graphic Design, Art History, and Advertising & Marketing, she combines theoretical knowledge with intuitive sensitivity to develop an authentic artistic language.
          </p>
          <p>
            Her practice focuses mainly on abstract art. She is especially drawn to vivid, luminous colors and dynamic compositions that convey life, joy, and emotion. She works with acrylic, oil, mixed media, drawing, inks, pastels, and hot/cold wax, allowing each piece to evolve organically without rigid rules.
          </p>
          <p>
            For Layla, painting is essential: it is her deepest and most beautiful way of expressing herself. Through painting, she communicates emotions, energy, and inner states beyond words. The canvas becomes a space of freedom, exploration, and truth, where color and movement speak directly to the viewer.
          </p>
          <p>
            Her artistic journey is enriched by continuous training in painting, drawing, human figure, creative expression, and mixed techniques, developed in Mexico and the United States. This diversity of experiences is reflected in expressive, vibrant work deeply connected to human experience.
          </p>
        </div>
        <div class="about-image" style="background: #d9cfc5;"></div>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .section {
    padding: 5rem 2rem;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
  }

  h2 {
    font-size: 2.5rem;
    font-weight: 300;
    letter-spacing: 0.05em;
    margin-bottom: 3rem;
    text-align: center;
    text-transform: uppercase;
  }

  .section-intro {
    font-size: 1.1rem;
    line-height: 1.8;
    color: #555;
    text-align: center;
    max-width: 900px;
    margin: 0 auto 3rem;
  }

  .section-footer {
    text-align: center;
    margin-top: 3rem;
  }

  .btn-secondary {
    display: inline-block;
    padding: 1rem 2.5rem;
    border: 2px solid #000;
    color: #000;
    text-decoration: none;
    transition: all 0.3s;
    font-size: 0.95rem;
    letter-spacing: 0.05em;
  }

  .btn-secondary:hover {
    background: #000;
    color: white;
  }

  .section-colecciones {
    background: white;
  }

  .paintings-carousel {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem 0;
  }

  .carousel-container {
    flex: 1;
    overflow: visible;
  }

  .carousel-track {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 2rem;
    align-items: start;
  }

  .painting-card {
    text-decoration: none;
    color: inherit;
    transition: transform 0.3s, box-shadow 0.3s;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.6rem;
    padding: 1rem;
    border: 1px solid #eee;
    background: #faf8f5;
    height: 100%;
    cursor: zoom-in;
  }

  .painting-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 16px 30px rgba(0, 0, 0, 0.08);
  }

  .painting-card img {
    width: 100%;
    height: 280px;
    object-fit: cover;
    display: block;
    border: 1px solid #e2e2e2;
    background: #f3f1ee;
  }

  .painting-card h3 {
    font-size: 1.1rem;
    font-weight: 700;
    text-align: center;
    color: #333;
    letter-spacing: 0.02em;
  }

  .painting-meta {
    margin-top: 0.15rem;
    font-size: 0.9rem;
    color: #555;
    text-align: center;
  }

  .painting-price {
    font-weight: 600;
    color: #1d1d1d;
  }

  .paintings-empty {
    grid-column: 1 / -1;
    text-align: center;
    color: #666;
    margin: 1rem 0;
  }

  /* Events */
  .section-eventos {
    background: #1a1a1a;
    color: #fff;
  }

  .section-eventos h2 {
    color: #fff;
    text-align: left;
  }

  .section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 3rem;
  }

  .see-more-link {
    color: #fff;
    text-decoration: none;
    font-size: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: opacity 0.3s;
  }

  .see-more-link:hover {
    opacity: 0.7;
  }

  .events-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
    gap: 0;
  }

  .event-card {
    background: transparent;
    padding: 0;
    position: relative;
    display: flex;
    flex-direction: column;
  }

  .event-badge {
    position: absolute;
    top: 2rem;
    left: 0;
    background: #000;
    color: white;
    padding: 0.5rem 1rem;
    font-size: 0.75rem;
    letter-spacing: 0.15em;
    z-index: 1;
    font-weight: 600;
  }

  .event-image {
    width: 100%;
    height: 400px;
    margin-bottom: 2rem;
  }

  .event-content {
    padding: 0 2rem 3rem 0;
  }

  .event-card h3 {
    font-size: 1.8rem;
    font-weight: 400;
    margin-bottom: 1rem;
    color: #fff;
    text-align: left;
  }

  .event-card p {
    color: #ccc;
    margin-bottom: 0.5rem;
    text-align: left;
    font-size: 1rem;
  }

  .event-location {
    font-weight: 600;
    margin-top: 1rem;
  }

  .event-link {
    color: #fff;
    text-decoration: none;
    border: 2px solid #fff;
    transition: all 0.3s;
    font-size: 0.95rem;
    display: inline-block;
    padding: 0.75rem 1.5rem;
    margin-top: 1rem;
  }

  .event-link:hover {
    background: #fff;
    color: #000;
  }

  /* News */
  .section-noticias {
    background: white;
  }

  .news-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 3rem;
  }

  .news-card {
    display: flex;
    flex-direction: column;
  }

  .news-image {
    width: 100%;
    height: 250px;
    margin-bottom: 1.5rem;
  }

  .news-content h3 {
    font-size: 1.3rem;
    font-weight: 400;
    margin-bottom: 1rem;
  }

  .news-content p {
    color: #666;
    margin-bottom: 1rem;
    text-align: left;
    font-size: 1rem;
    line-height: 1.6;
  }

  .news-link {
    color: #000;
    text-decoration: none;
    border-bottom: 1px solid #000;
    transition: opacity 0.3s;
    align-self: flex-start;
    font-size: 0.95rem;
  }

  .news-link:hover {
    opacity: 0.7;
  }

  /* About */
  .section-about {
    background: #f9f7f5;
  }

  .section-about .container {
    max-width: 1400px;
    padding: 0 1rem;
  }

  .about-content {
    display: grid;
    grid-template-columns: 1.3fr 1fr;
    gap: 3rem;
    align-items: center;
  }

  .about-text p {
    font-size: 1.1rem;
    line-height: 1.8;
    color: #555;
    margin-bottom: 1.5rem;
    text-align: left;
  }

  .about-image {
    width: calc(100% + 3cm);
    height: calc(400px + 3cm);
    margin-right: -3cm;
  }

  @media (max-width: 1024px) {
    .paintings-carousel {
      padding: 2rem 1rem;
    }

    .section {
      padding: 3rem 1rem;
    }
  }

  @media (max-width: 768px) {
    .categories-grid,
    .events-grid,
    .news-grid {
      grid-template-columns: 1fr;
    }

    .about-content {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .about-image {
      height: 300px;
      width: 100%;
      margin-right: 0;
    }

    h2 {
      font-size: 2rem;
    }

    .section-intro {
      font-size: 1rem;
      padding: 0 0.5rem;
    }

    .painting-card img {
      height: 280px;
    }

    .events-grid {
      gap: 2rem;
    }

    .event-card {
      padding: 0;
    }

    .event-content {
      padding: 0 1rem 2rem 0;
    }

    .news-grid {
      gap: 2rem;
    }
  }

  @media (max-width: 480px) {
    .section {
      padding: 2rem 0.5rem;
    }

    .container {
      padding: 0 1rem;
    }

    h2 {
      font-size: 1.75rem;
    }

    .painting-card img {
      height: 250px;
    }

    .event-image {
      height: 300px;
    }

    .event-card h3 {
      font-size: 1.4rem;
    }

    .news-image {
      height: 200px;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const cards = document.querySelectorAll('.painting-card');
    const lightbox = document.getElementById('lightbox');
    const imgTarget = document.getElementById('lightbox-img');
    const captionTarget = document.querySelector('.lightbox-caption');
    const closeBtn = document.querySelector('.lightbox-close');
    const backdrop = document.querySelector('.lightbox-backdrop');

    if (!lightbox || !imgTarget || !captionTarget || !closeBtn || !backdrop) return;

    const open = (src, alt, caption) => {
      imgTarget.src = src;
      imgTarget.alt = alt;
      captionTarget.textContent = caption;
      lightbox.classList.add('is-open');
      lightbox.setAttribute('aria-hidden', 'false');
    };

    const close = () => {
      lightbox.classList.remove('is-open');
      lightbox.setAttribute('aria-hidden', 'true');
      imgTarget.src = '';
      captionTarget.textContent = '';
    };

    cards.forEach(card => {
      card.addEventListener('click', event => {
        event.preventDefault();
        const img = card.querySelector('img');
        if (!(img instanceof HTMLImageElement)) return;
        const fullSrc = card.dataset.full || img.src;
        const caption = card.dataset.caption || card.querySelector('h3')?.textContent || '';
        open(fullSrc, img.alt || caption, caption);
      });
    });

    closeBtn.addEventListener('click', close);
    backdrop.addEventListener('click', close);
    document.addEventListener('keydown', event => {
      if (event.key === 'Escape') {
        close();
      }
    });
  });
</script>
